<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Customize your experience. Toggle dark mode, accessibility features, and more." />
  <title>Settings - Caleb's Profile</title>

  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="settings.css" />

  <script>
      // This self-executing function runs instantly to prevent a theme flicker.
      (function() {
        try {
          const storedSettings = localStorage.getItem('websiteSettings');
          if (!storedSettings) return; // Exit if no settings are saved

          const settings = JSON.parse(storedSettings);
          
          // Determine if dark mode should be active based on saved settings
          let isDark = false;
          if (settings.appearanceMode === 'dark') {
            isDark = true;
          } else if (settings.appearanceMode === 'device') {
            isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          }

          // If dark mode is determined to be active, add the class to the <html> tag
          if (isDark) {
            document.documentElement.classList.add('dark-mode');
          }
        } catch (e) {
          // If any error occurs, do nothing to avoid breaking the page.
          console.error("Flicker-prevention script error:", e);
        }
      })();
    </script>
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
</head>

<body class="settings-page">
  <main class="container" id="main-content">
    <div class="settings-section">
      <div class="settings-header">
        <h1>Settings</h1>
        <span class="version">v26.0</span>
      </div>

      <div class="settings-subsection">
        <h2 class="subsection-title">Appearance</h2>

        <div class="setting-card">
          <div class="setting-label">
            <strong class="setting-title">Appearance Mode</strong>
            <p class="setting-description">Choose light, dark, or follow your device setting.</p>
          </div>
          <div class="segmented-control" id="appearanceModeControl">
            <button type="button" data-value="device">Device</button>
            <button type="button" data-value="light">Light</button>
            <button type="button" data-value="dark">Dark</button>
          </div>
        </div>

        <div class="setting-card">
          <label for="accentColorPicker" class="setting-label">
            <strong class="setting-title">Accent Color</strong>
            <p class="setting-description">Pick a custom highlight color.</p>
          </label>
          <div class="accent-picker-container">
            <input
              type="color"
              id="accentColorPicker"
              value="#3ddc84"
              aria-label="Choose accent color"
            />
            <div id="accentColorPreview" class="accent-color-preview"></div>
          </div>
        </div>
      </div>

      <div class="settings-subsection">
        <h2 class="subsection-title">General</h2>
        <div class="setting-card">
          <label for="rearrangingEnabledToggle" class="setting-label">
            <strong class="setting-title">Enable Section Rearranging</strong>
            <p class="setting-description">Allow drag-and-drop to reorder sections on the homepage.</p>
          </label>
          <div class="md-switch">
            <input type="checkbox" id="rearrangingEnabledToggle" role="switch" aria-label="Toggle section rearranging" />
            <div class="track"><div class="thumb"></div></div>
          </div>
        </div>
        <div class="setting-card">
            <div class="setting-label">
                <strong class="setting-title">Reset Section Layout</strong>
                <p class="setting-description">Revert the homepage section order to the default layout.</p>
            </div>
            <button id="resetLayoutBtn" class="button reset-button">Reset</button>
        </div>
      </div>

      <div class="settings-subsection">
        <h2 class="subsection-title">Accessibility</h2>

        <div class="setting-card">
          <label for="text-size-slider" class="setting-label">
            <strong class="setting-title">Text Size</strong>
            <p class="setting-description">Adjust the text size for better readability</p>
          </label>
          <div class="text-size-control">
            <span id="textSizeValue" class="font-size-badge">16px</span>
            <input
              type="range"
              id="text-size-slider"
              min="12"
              max="24"
              value="16"
              step="1"
              aria-label="Adjust text size"
            />
          </div>
        </div>

        <div class="setting-card focus-outline-setting-card">
          <label for="focusOutlineToggle" class="setting-label">
            <strong class="setting-title">Focus Outline</strong>
            <p class="setting-description">Toggle the focus outline for accessibility purposes</p>
          </label>
          <div class="md-switch">
            <input type="checkbox" id="focusOutlineToggle" role="switch" aria-label="Toggle focus outline" />
            <div class="track"><div class="thumb"></div></div>
          </div>
        </div>

        <div class="setting-card">
          <label for="highContrastToggle" class="setting-label">
            <strong class="setting-title">High Contrast Mode</strong>
            <p class="setting-description">Increase contrast for easier readability.</p>
          </label>
          <div class="md-switch">
            <input type="checkbox" id="highContrastToggle" role="switch" aria-label="Toggle high contrast mode" />
            <div class="track"><div class="thumb"></div></div>
          </div>
        </div>

        <div class="setting-card">
          <label for="dyslexiaFontToggle" class="setting-label">
            <strong class="setting-title">Dyslexia-Friendly Font</strong>
            <p class="setting-description">Enable a more readable font for dyslexic users.</p>
          </label>
          <div class="md-switch">
            <input type="checkbox" id="dyslexiaFontToggle" role="switch" aria-label="Toggle dyslexia-friendly font" />
            <div class="track"><div class="thumb"></div></div>
          </div>
        </div>

        <div class="setting-card">
          <label for="underlineLinksToggle" class="setting-label">
            <strong class="setting-title">Underline Links</strong>
            <p class="setting-description">Always underline links to improve visibility.</p>
          </label>
          <div class="md-switch">
            <input type="checkbox" id="underlineLinksToggle" role="switch" aria-label="Toggle underline links" />
            <div class="track"><div class="thumb"></div></div>
          </div>
        </div>
      </div>

      <div class="settings-subsection">
        <h2 class="subsection-title">Visual Flair</h2>

        <div class="setting-card">
          <label for="mouseTrailToggle" class="setting-label">
            <strong class="setting-title">Mouse Trail Effect</strong>
            <p class="setting-description">Add a subtle glowing ripple that follows your cursor.</p>
          </label>
          <div class="md-switch">
            <input type="checkbox" id="mouseTrailToggle" role="switch" aria-label="Toggle mouse trail effect" />
            <div class="track"><div class="thumb"></div></div>
          </div>
        </div>
      </div>

      <div class="settings-subsection danger-zone">
        <h2 class="subsection-title">Danger Zone</h2>
        <div class="setting-card">
          <div class="setting-label">
            <strong class="setting-title">Reset to Factory Settings</strong>
            <p class="setting-description">Restore all settings to their default values</p>
          </div>
          <button id="resetSettings" class="button reset-button">Reset</button>
        </div>
      </div>

      <a href="/" class="back-link">← Back to Profile</a>
    </div>
  </main>

  <footer>
    <p>© <span id="year"></span> Caleb Kritzar. All Rights Reserved.</p>
    <div class="footer-links">
      <a href="privacy-policy.html">Privacy Policy</a>
      <a href="terms-of-service.html">Terms of Service</a>
      <a href="accessibility-statement.html">Accessibility Statement</a>
    </div>

    <div id="mouse-trail"></div>
  </footer>

  <script src="settings.js"></script>
  <script src="script.js"></script>
</body>
</html>
